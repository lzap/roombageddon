-- title:   ROOMBAGEDDON
-- author:  (c) 2026 Lukas Zapletal, Ondra Zapletal
-- desc:    A simple maze game.
-- site:    https://lukas.zapletalovi.com/roombageddon/
-- license: MIT License
-- script:  lua

package.path = package.path .. ";./src/?.lua"

require("consts")
local Director = require("scenes.director")
local IntroScene = require("scenes.intro")
local GameScene = require("scenes.game")
local GameOverScene = require("scenes.game_over")
--require("tools")

G = {
	Director = {},
}

function BOOT()
	--MarkCenters(2)
	--SwapRows(1, 6)

	local intro = IntroScene.New()
	local game = GameScene.New()
	local gameOver = GameOverScene.New()

	G.Director = Director.New()
	Director.Add(G.Director, "intro", intro, {
		onEnter = IntroScene.OnEnter,
		update = IntroScene.Update,
		draw = IntroScene.Draw,
	})
	Director.Add(G.Director, "game", game, {
		onEnter = GameScene.OnEnter,
		update = GameScene.Update,
		draw = GameScene.Draw,
	})
	Director.Add(G.Director, "game_over", gameOver, {
		update = GameOverScene.Update,
		draw = GameOverScene.Draw,
	})
	if FIRST_LEVEL ~= nil then
		Director.Switch(G.Director, "game")
	else
		Director.Switch(G.Director, "intro")
	end
end

function TIC()
	Director.Update(G.Director)
	Director.Draw(G.Director)
end

-- <TILES>
-- 001:ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
-- 002:000000000000000000000000000ff000000ff000000000000000000000000000
-- 032:cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
-- 033:cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
-- 034:cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
-- 035:cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
-- 064:ffffffffffff44fffff444ffff3f33ffffff33ffffff33ffffff33ffffffffff
-- 065:ffffffffff4444ffff4f44ffffff33fffff3ffffff3fffffff3333ffffffffff
-- 066:ffffffffff4444ffffff44fffff333fffff333ffffff33ffff3333ffffffffff
-- 067:ffffffffff4fffffff4fffffff3f33ffff3333ffffff33ffffff33ffffffffff
-- 080:ffffffffffff33fffff333ffff3f33ffffff33ffffff44ffffff44ffffffffff
-- 081:ffffffffff3333ffff3f33ffffff33fffff3ffffff4fffffff4444ffffffffff
-- 082:ffffffffff3333ffffff33fffff333fffff333ffffff44ffff4444ffffffffff
-- 083:ffffffffff3fffffff3fffffff3f33ffff3333ffffff44ffffff44ffffffffff
-- 096:ffffffffffff33fffff433ffff4f33ffffff33ffffff33ffffff33ffffffffff
-- 097:ffffffffff4433ffff4f33ffffff33fffff4ffffff4fffffff4433ffffffffff
-- 098:ffffffffff4433ffffff33fffff433fffff433ffffff33ffff4433ffffffffff
-- 099:ffffffffff4fffffff4fffffff4f33ffff4433ffffff33ffffff33ffffffffff
-- 112:ffffffffffff34fffff334ffff3f34ffffff34ffffff34ffffff34ffffffffff
-- 113:ffffffffff3334ffff3f34ffffff34fffff3ffffff3fffffff3334ffffffffff
-- 114:ffffffffff3334ffffff34fffff334fffff334ffffff34ffff3334ffffffffff
-- 115:ffffffffff3fffffff3fffffff3f34ffff3334ffffff34ffffff34ffffffffff
-- 128:ffffffffffffaafffffaaaffff9f99ffffff99ffffff99ffffff99ffffffffff
-- 129:ffffffffffaaaaffffafaaffffff99fffff9ffffff9fffffff9999ffffffffff
-- 130:ffffffffffaaaaffffffaafffff999fffff999ffffff99ffff9999ffffffffff
-- 131:ffffffffffafffffffafffffff9f99ffff9999ffffff99ffffff99ffffffffff
-- 144:ffffffffffff99fffff999ffff9f99ffffff99ffffffaaffffffaaffffffffff
-- 145:ffffffffff9999ffff9f99ffffff99fffff9ffffffafffffffaaaaffffffffff
-- 146:ffffffffff9999ffffff99fffff999fffff999ffffffaaffffaaaaffffffffff
-- 147:ffffffffff9fffffff9fffffff9f99ffff9999ffffffaaffffffaaffffffffff
-- 160:ffffffffffff99fffffa99ffffaf99ffffff99ffffff99ffffff99ffffffffff
-- 161:ffffffffffaa99ffffaf99ffffff99fffffaffffffafffffffaa99ffffffffff
-- 162:ffffffffffaa99ffffff99fffffa99fffffa99ffffff99ffffaa99ffffffffff
-- 163:ffffffffffafffffffafffffffaf99ffffaa99ffffff99ffffff99ffffffffff
-- 176:ffffffffffff9afffff99affff9f9affffff9affffff9affffff9affffffffff
-- 177:ffffffffff999affff9f9affffff9afffff9ffffff9fffffff999affffffffff
-- 178:ffffffffff999affffff9afffff99afffff99affffff9affff999affffffffff
-- 179:ffffffffff9fffffff9fffffff9f9affff999affffff9affffff9affffffffff
-- </TILES>

-- <SPRITES>
-- 000:cccccc77cccccc76c6226c75c3233776c3323775c6226c76cccccc75cccccc77
-- 001:cccccc77cccccc75c6226c76c3233775c3323776c6226c75cccccc76cccccc77
-- 016:cccccc77cccccc76c6996c75ca9aa776caa9a775c6996c76cccccc75cccccc77
-- 017:cccccc77cccccc75c6996c76ca9aa775caa9a776c6996c75cccccc76cccccc77
-- 224:00000000000cc000000cc0000eeddee00eeddee0000ee000000ee00000000000
-- 225:00000000000ee000000ee0000eeddcc00eeddcc0000ee000000ee00000000000
-- 226:00000000000ee000000ee0000eeddee00eeddee0000cc000000cc00000000000
-- 227:00000000000ee000000ee0000ccddee00ccddee0000ee000000ee00000000000
-- 228:0000000000099000009999000999999009999990009999000009900000000000
-- 229:0000000000066000006666000666666006666660006666000006600000000000
-- 230:0000000000022000002222000222222002222220002222000002200000000000
-- 231:0000000000055000005555000555555005555550005555000005500000000000
-- 232:0000000000000000000eeee000eeffe00eefffe00eeeeee00000000000000000
-- 233:00000000000000000eeee0000effee000efffee00eeeeee00000000000000000
-- 240:000000000eeccee00ecccce00ceccec00eeccee00eeccee00eeccee000000000
-- 241:000000000eeecee00eeeece00cccccc00cccccc00eeeece00eeecee000000000
-- 242:000000000eeccee00eeccee00eeccee00ceccec00ecccce00eeccee000000000
-- 243:000000000eeceee00eceeee00cccccc00cccccc00eceeee00eeceee000000000
-- 244:000000000eeccee00eceece00ecccce00eceece00eceece00eeeeee000000000
-- 245:000000000eeccee00eceece00ecceee00eeecce00ecccee00eeeeee000000000
-- 246:000000000ecccee00eceece00eceece00eceece00ecccee00eeeeee000000000
-- 247:000000000cecece00cecece00cecece00ccccce00ccecce00eeeeee000000000
-- 248:000000000ecccce00eeeece00eeccee00eceeee00ecccce00eeeeee000000000
-- 249:000000000eceece00eceece00eeccee00eceece00eceece00eeeeee000000000
-- 250:000000000eeeeee00eeeeee00eeeeee00eeeeee00eeeeee00eeeeee000000000
-- </SPRITES>

-- <MAP>
-- 006:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101010101010000000000000000000
-- 007:000000000000000000000000000000000000000000000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000071010101000000000000000000000000000000000000000000000000000000010100000000000000000000000000000000000000000000000000000101010101010160000000000000000000000000000000000000000000000101000000010100000000000000000000000000000000000000000000000000010101000000000000000000000000000000000000000000007101010000000100010100010000000000000000000
-- 008:000000000000000000000000071010101010100000000000000000000000000000000000000000000007101010101010101000000000000000000000000000000000000000000000000010101000000000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000101000200010100000000000000000000000000000000000000000000000071010001010160000000000000000000000000000000000000000101010000000100000000010000000000000000000
-- 009:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010100000000000000000000000000000000000000000000000000010101010100000000000000000000000000000000000000000000007101000101010100000000000000000000000000000000000000000000000071010101010100000000000000000000000000000000000000000000710101000000010101016000000000000000000000000000000000000000000000010101000000000000000000000000000000000000000000000101010000000100000101010000000000000000000
-- 010:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100010101010100000101010000000000000000000
-- 011:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000101000000000141010000000000000000000
-- 012:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000100000000000000000000000000000000000
-- 013:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101010100000000000000000000000000000000000
-- 022:000000000000000000000000000000000000000000000000000000000000000000000000000000000000101010101010100600000000000000000000000000000000001010000000000000000000000000000000000000000000000000000000000000000000091010101010050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 023:000000000000000000000000000900000005000000000000000000000000000000000000000000000000100010101000100000000000000000000000000000000000001810000000000000000000000000000000000000000000000000000000000000000000101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 024:000000000000000000000000001000000010000000000000000000000000000000000000000000000000100010001000100000000000000000000000000000000000000010000000000910101010000000001010000000000000000000000000000000000000101000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 025:000000000000000000000000101000200010100000000000000000000000000000000000000000000000100010001000100000000000000000000000000000000000000010000000001010201010000000001000000000000000000000000000000000000000100000200010000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- 026:000000000000000000000000101000000010100000000000000000000000000000000000000000000000100010001000100000000000000000000000000000000000001010000000001010101004000000001000000000000000000000000000000000000000101000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 027:000000000000000000000000001000000010000000000000000000000000000000000000000000000000100010101000100000000000000000000000000000000000000000000000000000000000000000001015000000000000000000000000000000000000101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 028:00000000000000000000000000101010101000000000000000000000000000000000000000000000000b101010101010100000000000000000000000000000000000000000000000000000000000000000001010000000000000000000000000000000000000141010101010180000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 042:000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- 059:000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- 076:000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- 093:000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- 103:001010101000000000000000000000000000000000000000001710101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 104:001000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 105:001000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 106:000400000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 107:000000000000000000000000000000000000000000000000000000000000000000000000071010101010000000000000001010101010160000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500000015000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 108:000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010001010101000000000000000000000000000000000000000000000000510101015000000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000000000000015001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 109:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010001000000000000000000000000000000000000000000000000010101010101010101000000000000000000000000000000000000000000000001000100010000000000000000000000000000000000000000000000010071010101010001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 110:000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000010101010001010101000000000000000000000000000000000000000000000001000200010000000000000000000000000000000000000000000000000001010201010001000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- 111:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010001000000000000000000000000000000000000000000000000010101010101010101000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000001010001010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 112:000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010001010101000000000000000000000000000000000000000000000003410101024000000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000003400000000002400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 113:000000000000000000000000000000000000000000000000000000000000000000000000371010101010000000000000001010101010260000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003400000024000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 114:001000000000000000000000000000000000000000000000000000002500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 115:001000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 116:001000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 117:001010103600000000000000000000000000000000000000001010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 127:000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- </MAP>

-- <WAVES>
-- 000:0123456789abcdeffedcba9876543210
-- 001:0123456789abcdeffedcba9876543210
-- 002:0123456789abcdeffedcba9876543210
-- 003:00112233445566778899aabbccddeeff
-- 004:02468abccba8642002468abccba86420
-- 005:0369cf9630369cf9630369cf9630369c
-- 006:048ce048ce048ce048ce048ce048ce04
-- 007:05af05af05af05af05af05af05af05af
-- 008:06c06c06c06c06c06c06c06c06c06c06
-- 009:07e507e507e507e507e507e507e507e5
-- 010:08080808080808080808080808080808
-- 011:091a091a091a091a091a091a091a091a
-- 012:0a3b0a3b0a3b0a3b0a3b0a3b0a3b0a3b
-- 013:0b5c0b5c0b5c0b5c0b5c0b5c0b5c0b5c
-- 014:0c7d0c7d0c7d0c7d0c7d0c7d0c7d0c7d
-- 015:0d9e0d9e0d9e0d9e0d9e0d9e0d9e0d9e
-- </WAVES>

-- <SFX>
-- 000:570017008700d700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700c00000000000
-- 001:560016008650160046707600c690f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600280000000000
-- </SFX>

-- <FLAGS>
-- 000:10204000000000000000000000000000000000000000000000000000000000001010101000000000000000000000000000000000000000000000000000000000202020200000000000000000000000002020202000000000000000000000000020202020000000000000000000000000202020200000000000000000000000002020202000000000000000000000000020202020000000000000000000000000202020200000000000000000000000002020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </FLAGS>

-- <PALETTE>
-- 000:1a1c2c5d275db13e53ef7d57ffcd75a7f07038b76425717929366f3b5dc941a6f673eff7f4f4f494b0c2566c86333c57
-- </PALETTE>

