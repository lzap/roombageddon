-- title:   ROOMBAGEDDON
-- author:  (c) 2026 Lukáš Zapletal, Ondra Zapletal
-- desc:    A simple maze game.
-- site:    https://lukas.zapletalovi.com/roombageddon/
-- license: MIT License
-- script:  lua

package.path = package.path .. ";./src/?.lua"

local SceneManager = require("scenes.scene_manager")
local IntroScene = require("scenes.intro")
local GameScene = require("scenes.game")
local GameOverScene = require("scenes.game_over")
--local Tools = require("tools")

G = {
	SM = {},
}

function BOOT()
	--Tools.MarkCenters(2)
	--Tools.SwapRows(0, 1)

	local intro = IntroScene.New()
	local game = GameScene.New()
	local gameOver = GameOverScene.New()

	G.SM = SceneManager.New()
	SceneManager.Add(G.SM, "intro", intro, {
		update = IntroScene.Update,
		draw = IntroScene.Draw,
	})
	SceneManager.Add(G.SM, "game", game, {
		onEnter = GameScene.OnEnter,
		update = GameScene.Update,
		draw = GameScene.Draw,
	})
	SceneManager.Add(G.SM, "game_over", gameOver, {
		update = GameOverScene.Update,
		draw = GameOverScene.Draw,
	})
	SceneManager.Switch(G.SM, "intro")
end

function TIC()
	SceneManager.Update(G.SM)
	SceneManager.Draw(G.SM)
end

-- <TILES>
-- 001:ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
-- 002:000000000000000000000000000ff000000ff000000000000000000000000000
-- 032:cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
-- 033:cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
-- 034:cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
-- 035:cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
-- 064:ffffffffffff44fffff444ffff3f33ffffff33ffffff33ffffff33ffffffffff
-- 065:ffffffffff4444ffff4f44ffffff33fffff3ffffff3fffffff3333ffffffffff
-- 066:ffffffffff4444ffffff44fffff333fffff333ffffff33ffff3333ffffffffff
-- 067:ffffffffff4fffffff4fffffff3f33ffff3333ffffff33ffffff33ffffffffff
-- 080:ffffffffffff33fffff333ffff3f33ffffff33ffffff44ffffff44ffffffffff
-- 081:ffffffffff3333ffff3f33ffffff33fffff3ffffff4fffffff4444ffffffffff
-- 082:ffffffffff3333ffffff33fffff333fffff333ffffff44ffff4444ffffffffff
-- 083:ffffffffff3fffffff3fffffff3f33ffff3333ffffff44ffffff44ffffffffff
-- 096:ffffffffffff33fffff433ffff4f33ffffff33ffffff33ffffff33ffffffffff
-- 097:ffffffffff4433ffff4f33ffffff33fffff4ffffff4fffffff4433ffffffffff
-- 098:ffffffffff4433ffffff33fffff433fffff433ffffff33ffff4433ffffffffff
-- 099:ffffffffff4fffffff4fffffff4f33ffff4433ffffff33ffffff33ffffffffff
-- 112:ffffffffffff34fffff334ffff3f34ffffff34ffffff34ffffff34ffffffffff
-- 113:ffffffffff3334ffff3f34ffffff34fffff3ffffff3fffffff3334ffffffffff
-- 114:ffffffffff3334ffffff34fffff334fffff334ffffff34ffff3334ffffffffff
-- 115:ffffffffff3fffffff3fffffff3f34ffff3334ffffff34ffffff34ffffffffff
-- </TILES>

-- <SPRITES>
-- 000:cccccc77cccccc76c6556c75c4544776c4454775c6556c76cccccc75cccccc77
-- 001:cccccc77cccccc75c6556c76c4544775c4454776c6556c75cccccc76cccccc77
-- </SPRITES>

-- <MAP>
-- 006:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101010101010000000000000000000
-- 007:000000000000000000000000000000000000000000000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000071010101000000000000000000000000000000000000000000000000000000010100000000000000000000000000000000000000000000000000000101010101010160000000000000000000000000000000000000000000000101000000010100000000000000000000000000000000000000000000000000010101000000000000000000000000000000000000000000007101010000000100010100010000000000000000000
-- 008:000000000000000000000000071010101010100000000000000000000000000000000000000000000007101010101010101000000000000000000000000000000000000000000000000010101000000000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000101000200010100000000000000000000000000000000000000000000000071010001010160000000000000000000000000000000000000000101010000000100000000010000000000000000000
-- 009:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010100000000000000000000000000000000000000000000000000010101010100000000000000000000000000000000000000000000007101000101010100000000000000000000000000000000000000000000000071010101010100000000000000000000000000000000000000000000710101000000010101016000000000000000000000000000000000000000000000010101000000000000000000000000000000000000000000000101010000000100000101010000000000000000000
-- 010:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100010101010100000101010000000000000000000
-- 011:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000101000000000141010000000000000000000
-- 012:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000100000000000000000000000000000000000
-- 013:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101010100000000000000000000000000000000000
-- 018:001010101000000000000000000000000000000000000000001710101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 019:001000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 020:001000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 021:000400000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 022:000000000000000000000000000000000000000000000000000000000000000000000000071010101010000000000000001010101010160000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500000015000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 023:000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010001010101000000000000000000000000000000000000000000000000510101015000000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000000000000015001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 024:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010001000000000000000000000000000000000000000000000000010101010101010101000000000000000000000000000000000000000000000001000100010000000000000000000000000000000000000000000000010071010101010001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 025:000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000010101010001010101000000000000000000000000000000000000000000000001000200010000000000000000000000000000000000000000000000000001010201010001000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- 026:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010001000000000000000000000000000000000000000000000000010101010101010101000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000001010001010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 027:000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010001010101000000000000000000000000000000000000000000000003410101024000000000000000000000000000000000000000000000000001010101010000000000000000000000000000000000000000000000000003400000000002400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 028:000000000000000000000000000000000000000000000000000000000000000000000000371010101010000000000000001010101010260000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003400000024000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 029:001000000000000000000000000000000000000000000000000000002500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 030:001000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 031:001000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 032:001010103600000000000000000000000000000000000000001010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 042:000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- 059:000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- 076:000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- 093:000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- 110:000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- 127:000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000200000000000000000000000000000
-- </MAP>

-- <WAVES>
-- 000:0123456789abcdeffedcba9876543210
-- 001:0123456789abcdeffedcba9876543210
-- 002:0123456789abcdeffedcba9876543210
-- 003:00112233445566778899aabbccddeeff
-- 004:02468abccba8642002468abccba86420
-- 005:0369cf9630369cf9630369cf9630369c
-- 006:048ce048ce048ce048ce048ce048ce04
-- 007:05af05af05af05af05af05af05af05af
-- 008:06c06c06c06c06c06c06c06c06c06c06
-- 009:07e507e507e507e507e507e507e507e5
-- 010:08080808080808080808080808080808
-- 011:091a091a091a091a091a091a091a091a
-- 012:0a3b0a3b0a3b0a3b0a3b0a3b0a3b0a3b
-- 013:0b5c0b5c0b5c0b5c0b5c0b5c0b5c0b5c
-- 014:0c7d0c7d0c7d0c7d0c7d0c7d0c7d0c7d
-- 015:0d9e0d9e0d9e0d9e0d9e0d9e0d9e0d9e
-- </WAVES>

-- <SFX>
-- 000:570017008700d700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700f700c00000000000
-- 001:560016008650160046707600c690f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600f600280000000000
-- </SFX>

-- <FLAGS>
-- 000:10204000000000000000000000000000000000000000000000000000000000001010101000000000000000000000000000000000000000000000000000000000202020200000000000000000000000002020202000000000000000000000000020202020000000000000000000000000202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </FLAGS>

-- <PALETTE>
-- 000:1a1c2c5d275db13e53ef7d57ffcd75a7f07038b76425717929366f3b5dc941a6f673eff7f4f4f494b0c2566c86333c57
-- </PALETTE>

